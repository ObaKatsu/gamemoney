<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯”è³½æ´»å‹•æˆæœ¬æç›Šåˆ†æå™¨</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --success: #27ae60;
            --danger: #c0392b;
            --light: #ecf0f1;
        }
        body {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 30px;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 10px;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        @media (max-width: 768px) {
            .grid { grid-template-columns: 1fr; }
        }
        .section {
            background: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .section h3 {
            margin-top: 0;
            color: var(--primary);
        }
        .input-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box; /* Fix padding issue */
            font-size: 16px;
        }
        .result-card {
            background: #fff;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .result-value {
            font-size: 2em;
            font-weight: bold;
            color: var(--primary);
        }
        .profit { color: var(--success); }
        .loss { color: var(--danger); }
        
        .analysis-box {
            background-color: #e8f6f3;
            border-left: 5px solid var(--accent);
            padding: 15px;
            margin-top: 20px;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: var(--accent);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
        }
        .btn:hover { background-color: #2980b9; }
        .row-total {
            border-top: 1px solid #ccc;
            margin-top: 10px;
            padding-top: 5px;
            font-weight: bold;
            text-align: right;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ† æ¯”è³½æ´»å‹•æˆæœ¬æç›Šåˆ†æå™¨</h1>

    <div class="grid">
        <div>
            <div class="section">
                <h3>1. å›ºå®šæˆæœ¬ (ä¸è«–äººæ•¸éƒ½è¦ä»˜)</h3>
                <div class="input-group">
                    <label>å·¥ä½œäººå“¡äººæ•¸</label>
                    <input type="number" id="staffCount" value="3">
                </div>
                <div class="input-group">
                    <label>æ¯ä½å·¥ä½œäººå“¡è²»ç”¨ ($)</label>
                    <input type="number" id="staffCost" value="2000">
                </div>
                <div class="input-group">
                    <label>å…¶ä»–å›ºå®šé›œæ”¯ (è¡ŒéŠ·/å¸ƒç½®) ($)</label>
                    <input type="number" id="otherFixed" value="1000" placeholder="ä¾‹å¦‚ï¼šæ°´ã€ä¾¿ç•¶ã€å»£å‘Š">
                </div>
                <div class="row-total">å›ºå®šæˆæœ¬å°è¨ˆ: $<span id="totalFixedDisplay">0</span></div>
            </div>

            <div class="section">
                <h3>2. è®Šå‹•æˆæœ¬ (æ¯å¤šä¸€äººå°±è¦ä»˜)</h3>
                <div class="input-group">
                    <label>æ¯äººå ´åœ°è²» ($)</label>
                    <input type="number" id="varVenue" value="500">
                </div>
                <div class="input-group">
                    <label>æ¯äººçå“è²» ($)</label>
                    <input type="number" id="varPrize" value="100">
                </div>
                <div class="row-total">å–®äººè®Šå‹•æˆæœ¬: $<span id="totalVarDisplay">0</span></div>
            </div>

            <div class="section" style="border: 2px solid var(--accent); background: white;">
                <h3>3. ç‡Ÿæ”¶é æ¸¬</h3>
                <div class="input-group">
                    <label>é è¨ˆå ±åè²» (æ¯äºº) ($)</label>
                    <input type="number" id="ticketPrice" value="1200">
                </div>
                <div class="input-group">
                    <label>é ä¼°åƒè³½äººæ•¸</label>
                    <input type="number" id="participants" value="25">
                </div>
            </div>
        </div>

        <div>
            <div class="section">
                <h3>ğŸ“Š è²¡å‹™åˆ†æçµæœ</h3>
                
                <div class="result-card">
                    <label>é ä¼°ç¸½åˆ©æ½¤ (æ·¨åˆ©)</label>
                    <div class="result-value" id="netProfit">0</div>
                </div>

                <div style="margin-top: 15px;">
                    <label>æç›Šå…©å¹³é» (è‡³å°‘è¦æ”¶å¤šå°‘éŒ¢/äºº)</label>
                    <div style="font-size: 1.2em; font-weight:bold;" id="breakEvenPrice">0</div>
                    <small>ä»¥ç•¶å‰äººæ•¸è¨ˆç®—</small>
                </div>

                <div style="margin-top: 15px;">
                    <label>å®‰å…¨äººæ•¸ (è‡³å°‘è¦æœ‰å¹¾äººå ±å)</label>
                    <div style="font-size: 1.2em; font-weight:bold;" id="breakEvenCount">0</div>
                    <small>ä»¥ç•¶å‰å®šåƒ¹è¨ˆç®—</small>
                </div>
                
                <hr>
                
                <p><strong>ç¸½æ”¶å…¥ï¼š</strong> $<span id="totalRevenue">0</span></p>
                <p><strong>ç¸½æ”¯å‡ºï¼š</strong> $<span id="totalExpense">0</span></p>
            </div>

            <div class="analysis-box" id="analysisText">
                é¡§å•å»ºè­°å°‡é¡¯ç¤ºæ–¼æ­¤...
            </div>
        </div>
    </div>
</div>

<script>
    // ç²å– DOM å…ƒç´ 
    const inputs = document.querySelectorAll('input');
    
    // ç¶å®šäº‹ä»¶
    inputs.forEach(input => {
        input.addEventListener('input', calculate);
    });

    function calculate() {
        // 1. ç²å–æ•¸å€¼
        const staffCount = Number(document.getElementById('staffCount').value) || 0;
        const staffCost = Number(document.getElementById('staffCost').value) || 0;
        const otherFixed = Number(document.getElementById('otherFixed').value) || 0;
        
        const varVenue = Number(document.getElementById('varVenue').value) || 0;
        const varPrize = Number(document.getElementById('varPrize').value) || 0;
        
        const ticketPrice = Number(document.getElementById('ticketPrice').value) || 0;
        const participants = Number(document.getElementById('participants').value) || 0;

        // 2. è¨ˆç®—é‚è¼¯
        const totalFixed = (staffCount * staffCost) + otherFixed;
        const unitVariable = varVenue + varPrize;
        
        const totalRevenue = ticketPrice * participants;
        const totalExpense = totalFixed + (unitVariable * participants);
        const profit = totalRevenue - totalExpense;

        // æç›Šå…©å¹³åƒ¹æ ¼ (Total Fixed / Participants) + Unit Variable
        const bepPrice = participants > 0 ? (totalFixed / participants) + unitVariable : 0;

        // æç›Šå…©å¹³äººæ•¸ (Total Fixed / (Ticket Price - Unit Variable))
        const contributionMargin = ticketPrice - unitVariable;
        let bepCount = 0;
        let bepText = "";
        
        if (contributionMargin <= 0) {
            bepText = "ç„¡æ³•å›æœ¬ (å®šåƒ¹éä½)";
        } else {
            bepCount = Math.ceil(totalFixed / contributionMargin);
            bepText = bepCount + " äºº";
        }

        // 3. æ›´æ–°é¡¯ç¤º
        document.getElementById('totalFixedDisplay').innerText = totalFixed.toLocaleString();
        document.getElementById('totalVarDisplay').innerText = unitVariable.toLocaleString();
        document.getElementById('totalRevenue').innerText = totalRevenue.toLocaleString();
        document.getElementById('totalExpense').innerText = totalExpense.toLocaleString();
        
        const profitEl = document.getElementById('netProfit');
        profitEl.innerText = "$" + profit.toLocaleString();
        if (profit >= 0) {
            profitEl.className = "result-value profit";
            profitEl.innerText = "+$" + profit.toLocaleString();
        } else {
            profitEl.className = "result-value loss";
        }

        document.getElementById('breakEvenPrice').innerText = "$" + Math.ceil(bepPrice).toLocaleString();
        document.getElementById('breakEvenCount').innerText = bepText;

        // 4. é¡§å•å‹•æ…‹å»ºè­°
        const analysisEl = document.getElementById('analysisText');
        let advice = "";

        if (profit < 0) {
            advice = "âš ï¸ <strong>è­¦å‘Šï¼šç›®å‰çš„è¨­å®šæœƒè™§æï¼</strong><br>å»ºè­°ï¼šæé«˜å ±åè²»ï¼Œæˆ–æ˜¯å¢åŠ åƒè³½äººæ•¸ã€‚";
            if (contributionMargin <= 0) {
                advice += "<br>âŒ <strong>åš´é‡å•é¡Œï¼š</strong>ä½ çš„å ±åè²»é€£æ”¯ä»˜å ´åœ°å’Œçå“éƒ½ä¸å¤ ï¼ˆæ¯äººåšç™½å·¥ï¼‰ï¼Œå®Œå…¨ç„¡æ³•åˆ†æ”¤å·¥ä½œäººå“¡è²»ç”¨ã€‚";
            }
        } else {
            const marginRate = (profit / totalRevenue * 100).toFixed(1);
            advice = `âœ… <strong>è¨ˆç•«å¯è¡Œï¼</strong><br>é ä¼°æ·¨åˆ©ç‡ç‚º <strong>${marginRate}%</strong>ã€‚`;
            
            if (participants < bepCount + 3) {
                advice += "<br>âš ï¸ <strong>æ³¨æ„ï¼š</strong>é›–ç„¶ç²åˆ©ï¼Œä½†é›¢æç›Šå…©å¹³é»å¾ˆè¿‘ï¼Œè‹¥æœ‰å¹¾äººè‡¨æ™‚ç¼ºå¸­å¯èƒ½æœƒè™§æã€‚";
            } else {
                advice += "<br>ğŸ’¼ é€™å€‹æ¨¡å‹ç›¸ç•¶ç©©å¥ï¼Œæœ‰è¶³å¤ çš„æŠ—é¢¨éšªèƒ½åŠ›ã€‚";
            }
        }
        analysisEl.innerHTML = advice;
    }

    // åˆå§‹åŒ–è¨ˆç®—
    calculate();
</script>

</body>
</html>